# Campaign Customization Delivery Plan

## 1. Цели программы
- Обеспечить HR-архитекторам гибкую настройку кампаний под разные целевые аудитории и типы воронок.
- Синхронизировать настройки конструктора с личным кабинетом кадета (и офицера), включая визуальный стиль, терминологию мотивации и нарратив.
- Встроить AI Copilot, который ускоряет настройку тем, нарратива и контента миссий через структурированный вывод.

## 2. Домен: воронки и мотиваторы
Каждая воронка кампании определяет набор мотивационных элементов, отображаемых в личном кабинете кадета:

| Тип воронки | Основной мотиватор | Терминология | Примеры метрик |
| --- | --- | --- | --- |
| Onboarding / адаптация | Ранги и прогресс | «Ранг», "Опыт (XP)", «Бейджи» | Завершение миссий, скорость адаптации |
| Engagement / вовлечение | Энергия / ресурсы | "Мана", «Энергия», «Уровень вовлеченности» | Еженедельные активности, streak |
| Assessment / отбор | Достижения и рейтинг | «Испытания», «Титулы», "Сертификаты" | Баллы оценок, место в рейтинге |
| Growth / развитие | Навыковые треки | «Компетенции», «Skill Points», «Наставник» | Рост компетенций, feedback |
| ESG / ценности | Вклад и влияние | «Вклад», «Импакт», «Миссия» | Волонтёрские часы, социальные проекты |

Все названия и показатели должны настраиваться в конструкторе и попадать в клиентские интерфейсы.

## 3. Целевые аудитории и уровни геймификации
- Персона кампании определяет допустимый уровень геймификации, терминологию и визуальный тон.
- В конструкторе HR отмечает одну или несколько целевых аудиторий, настраивает интенсивность геймификации (high / balanced / low) и, при необходимости, вручную переименовывает валюты и ранги.

| Персона | Характеристики | Допустимая геймификация | Рекомендованные мотиваторы | Suggested темы |
| --- | --- | --- | --- | --- |
| Студенты, стажёры (18–25) | Digital natives, высокий интерес к играм | **High**: яркие эффекты, ачивки, эмодзи | XP, мана, streak, лидерборды | «Галактическая академия», «Ретро-аркада», «Спортивная лига» |
| Специалисты 26–35 | Нацелены на рост и влияние | **Balanced**: геймификация с профессиональным тоном | Ранги, компетенции, титулы | «Киберпанк-хаб», «Научная экспедиция», «Корпоративный мегаполис» |
| Опытные сотрудники 35–45 | Ценят практичность и статус | **Low/Balanced**: минимум визуального шума, упор на KPI | KPI, бонусы, наставничество | «Корпоративный мегаполис», «Кабинет наставника» |
| Производственные команды 40–55 | Практичный взгляд, мало времени | **Low**: простые интерфейсы, реальные выгоды | Смена, надбавка, безопасность | Упрощённые версии тем (корпоративная, ESG) |
| Волонтёры / ESG сообщества | Замотивированы Impact-историями | **Balanced**: нарратив + признание | Вклад, импакт, миссия | «ESG-миссия», «Мифический орден» |

- Для смешанных аудиторий применяются гибридные настройки: базовая тема + альтернативные словари для конкретных сегментов, а аналитика помогает увидеть, какой сегмент реагирует на какую конфигурацию.

Настройки, сохраняемые в кампании:
- `personas`: массив выбранных целевых аудиторий.
- `gamificationLevel`: high / balanced / low (управляет визуальными эффектами и тоном).
- `motivationOverrides`: кастомные названия валют и рангов.
- Флаги отключения/включения анимаций, аудио, уведомлений.

Клиентские интерфейсы должны использовать эти параметры, чтобы адаптировать язык, оформление и приоритеты блоков.

## 4. Тематические пакеты и UX кадета
Темы определяют визуал и нарратив кабинета, с привязкой к выбранной воронке:

| Тема | Подходящая воронка | Набор мотивации | Влияние на UI | Пример нарратива |
| --- | --- | --- | --- | --- |
| Галактическая академия (baseline) | Onboarding, Growth | Ранги, XP, Мана | Космические градиенты, голографические карты | «Кадет, пройди симуляцию, чтобы получить новый ранг» |
| Киберпанк-хаб | Engagement, Assessment | Энергия, Репутация | Неон, «глитчи», панели с цифровыми уровнями | «Навигируй в VR-квартале, взломай терминал» |
| Мифический орден | Growth, ESG | Титулы, Артефакты | Пергамент, рунические бейджи | «Пройди испытание воды, чтобы получить печать» |
| Научная экспедиция | Assessment, Growth | Исследовательские очки, Рейтинг | Светлые панели, графики | «Собери данные по экспедиции, представь отчёт» |
| Корпоративный мегаполис | Onboarding, Engagement | KPI, Бонусы | Строгие карточки, инфографика | «Защити проект, поднимись на этаж выше» |
| Кабинет наставника | Growth | Soft skills, Feedback | Тёплые тона, hand-written элементы | «Наставник оценил твоё домашнее задание» |
| Спортивная лига | Engagement | Очки матча, Лига | Табло, динамические анимации | «Выиграй матч, чтобы перейти в высшую лигу» |
| ESG-миссия | ESG | Вклад, Импакт | Природные мотивы, «зелёные» бейджи | «Каждый волонтёрский час приближает тебя к статусу Guardian» |
| Ретро-аркада | Engagement, Onboarding | Жизни, Уровни | Пиксельная стилистика, аркадные звуки | «Собери 3 power-up, чтобы разблокировать босс-миссию» |
| Путешествие во времени | Assessment | Эпохи, Хронобаланс | Микс ретро/фьючеристики | «Стабилизируй временной поток, закрой парадокс» |

Каждая тема связывается с пакетом ассетов (цветовые токены, иконки, фон, аудио) и набором терминов мотивации.

## 5. Функциональные требования конструктора
1. **Панель кампании** (MissionFlowEditor level):
   - Выбор темы из каталога + предпросмотр (палитра, иконки, аудио).
   - Выбор типа воронки → подтягиваются дефолтные мотиваторы и терминология.
   - Ручная настройка: названия валют (XP, Мана и т.д.), названия рангов/титулов, единицы прогресса.
   - Набор ассетов: загрузить изображения/иконки, выбрать аудио, указать фон.
   - Нарратив кампании: название арки, описание кампании, тон общения.
   - Управление персонами: выбор ЦА, уровень геймификации, включение/отключение эффектов.

2. **Маппинг на UI кадета**:
   - Карта миссий (`MissionNode`, ReactFlow) принимает тему → цвета, фоны, иконки.
   - Дашборд кадета (`CadetOverview`, `CadetGalacticMap`) — темы меняют карточки статуса, названия мотивации, иконки.
   - Тестовый режим (`TestModePanel`) — оформление HUD и статусы в стиле темы.
   - Точки мотивации: список рангов, прогресс бар, валюта (XP/мана) подтягиваются из кампании.

3. **Панель офицера**: оформление по теме кампании, но с более «оперативным» UI (можно иметь тему + минимальный скин).

4. **Аналитика воронки**:
   - В конструкторе настраиваются контрольные точки (миссии, этапы, тестовые сценарии), для которых собирается аналитика по выбранным персонам.
   - HR видит, какие сегменты пользователей доходят до конца, на каких узлах возникает отток, как влияет выбранная тема/мотиватор.
   - Возможность запускать A/B конфигурации (разные темы/мотиваторы) и сравнивать конверсию.
   - Отчёты показывают «вклад» каждого элемента (миссия, мотиватор, визуальная тема) в успешное завершение воронки по сегментам.

## 6. AI Copilot: расширенный сценарий
- **Structured Output**: модель возвращает объект `CampaignThemeConfig` с полями:
  - `themeId`, `palette`, `iconPack`, `background`, `audio`.
  - `funnelType`, `motivators` (названия валют, рангов, бейджей).
  - `narrative` (story arc, mission synopsis, tone).
  - `recommendedMissions` (id шаблонов, связи).
- **Интерактивный мастер**:
  1. HR выбирает тип воронки, целевую аудиторию, желаемый сеттинг.
  2. AI предлагает тему + конфиг.
  3. HR подтверждает: настройки применяются → UI кадета обновится.
  4. AI может сгенерировать текст миссий, подсказки по компетенциям.
- **Интеграция**: кнопка `ИИ-пилот` в редакторе открывает мастер выбора сценария «Сгенерировать тему/нарратив/миссии».

## 7. План внедрения (дорожная карта)
1. **Модель данных**
   - Добавить `themeConfig` в `Campaign` (JSON): хранить палитры, мотиваторы, ассеты, нарратив.
   - Добавить справочники тем (`/data/theme-presets.ts`) и мотиваторов по типам воронок.

2. **UI конструктора**
   - Разработать «Campaign Settings Panel» (в MissionFlowEditor или отдельный компонент).
   - Включить выбор типа воронки, темы, ручную настройку терминологии и ассетов.
   - Сохранение настроек через `/api/campaigns/[id]`.

3. **Стилизация клиентских интерфейсов**
   - Прокинуть конфиг темы в `CadetOverview`, `CadetGalacticMap`, `MissionExecutor` и другие компоненты.
   - Адаптировать отображение валют/рангов/бонусов в зависимости от настроек кампании.
   - Настроить фоллбек на baseline тему.

4. **Интеграция AI Copilot**
   - Подготовить промты для тем + мотиваторов.
   - Реализовать API (e.g. `/api/ai/theme-suggestion`) возвращающий структурированный ответ.
   - Встроить мастер выбора сценария в `ИИ-пилот`.

5. **Ассет менеджмент**
   - Решить хранение изображений/аудио (S3/CDN).
   - Реализовать загрузку через конструктор и привязку к кампании.

6. **Методологии использования**
   - Template-first: HR выбирает готовую карту, AI адаптирует под тему.
   - Theme-first: HR начинает с темы и нарратива, затем создаёт миссии.
   - Objective-first: HR задаёт цели, AI предлагает тему + структуру.
   - Analytics-first: HR анализирует текущие метрики по персонам и запускает AI для генерации рекомендаций по корректировке темы/мотиваторов на основе данных.

7. **Аналитика и эксперименты**
   - Настроить события воронки: вход, переходы между миссиями, завершение, выход.
   - Сегментировать метрики по персонам, темам, уровням геймификации.
   - Встроить дешборд сравнения конфигураций (A/B, последовательные итерации), включая графики drop-off по этапам и сегментам.
   - Подготовить рекомендации AI на основе собранных данных (что изменить для улучшения конверсии).
   - Интегрировать сигналы в конструктор: подсвечивать миссии/узлы с высокой долей оттока и предлагать изменить тему/мотиватор.

8. **QA & обучение**
   - Протестировать, что изменения в конструкторе отражаются в ЛК кадета/офицера.
   - Подготовить гайды для HR по настройке тем и работе с AI-помощником.
   - Настроить сценарии юзабилити-тестов для разных персон.

## 8. Ключевые зависимости
- ReactFlow/MissionNode должны поддерживать динамические стили.
- Компоненты личного кабинета читают конфиг кампании (через API/SSR).
- Аудиопроигрывание и фоновые эффекты — опциональные, но должны иметь fallbacks.
- AI Copilot требует API ключи, ограничения и логирование.
- Аналитика требует событийной схемы (Snowplow/PostHog/Amplitude) и идентификации сегментов.

## 9. Риски и меры
- **Перегрузка HR UI**: обеспечить clean UX, скрывать продвинутые настройки за «advanced mode».
- **Неполные ассеты**: реализовать fallback визуалы и предупреждения.
- **Обновление тем в уже запущенных кампаниях**: предусмотреть версии и предупреждение о влиянии на пользователей.
- **Производительность**: кеширование конфигов, lazy-loading ассетов.
- **Искажение метрик**: валидировать события и сегментацию перед запуском тестов.

## 10. Итог
- Архитектор может настроить тему, мотиваторы и нарратив в конструкторе.
- Личный кабинет кадета/офицера автоматически подстраивается под выбранные параметры.
- AI Copilot помогает выбрать тему и заполнить контент.
- Аналитика позволяет измерять эффективность воронки по персонам и быстро корректировать конфигурацию.

